# Operating System

## Charpter 05 교착 상태

### 1. 교착 상태의 정의와 사용 예

#### 교착 상태의 정의

- 하나 또는 둘 이상의 프로세스가 더 이상 계속할 수 없는 어떤 특정 사건을 기다리는 상태를 말한다. 여기서 특정 사건이란 자원의 할당과 해제를 의미한다.
- 둘 이상의 서로 다른 프로세스가 요구한 자원을 할당받아 점유하고 있으면서 상호 간에 상대방 프로세스가 가진 자원을 요구하는 때를 말한다.

#### 교착 상태의 예

##### 1. 환형 대기

![교착상태](https://user-images.githubusercontent.com/38815618/86478304-09be7c00-bd85-11ea-8396-22e058f05deb.PNG)

- 환형 대기(circular wait)란 각 프로세스가 자신에게 할당된 자원을 가지고 있으면서 상대방 프로세스의 자원을 요구하는 상태를 말한다.
- 자신이 자원을 끈질기게 보유하고 있으면서 다른 자원을 요구하므로 한편으로는 치명적인 포옹(deadly embrace)이라고 한다.

##### 2. 프린터에서의 교착 상태

> 사용자 프로세스가 주기억 장치의 데이터를 행 단위로 출력하려고 프린터로 보낸 출력 행 전체가 프린트될 때까지 기다렸다가 다음 행을 보낸다면 프린터의 속도 때문에 사용자 프로세스의 실행 속도는 느려질 것이다.

- 일반적으로 스풀링에서는 대용량의 디스크에 고속으로 보내어서 일단 저장하였다가 나중에 서서히 프린터로 출력되게 하고 있다.
- 현재 수행 중인 여러 작업이 인쇄할 행을 만들어 스풀링 파일로 보내고 있는 도중 이미 스풀링 파일 공간이 차 버린 때에는 교착 상태에 빠지게 된다.

### 2. 무한 연기와 노화 기법

|무한 연기|교착 상태|
|---|---|
|어떤 특정 프로세스가 자원을 할당받으려고 무한정 기다리는 상태이다.|시스템에 있는 여러 개 또는 모든 프로세스가 아무 일도 못하고 어떤 특정 사건을 기다리며 무기한 연기된 상태이다.|
|자원의 편중된 분배 정책으로 발생하며 노화 기법(aging)으로 해결된다.|상호 배제, 점유와 대기, 비선점, 환형 대기와 같은 조건으로 발생하며 이를 부정함으로써 해결한다.|

- 무한 연기의 발생 원인은 시스템(운영 체제)의 편중된 자원 할당 정책 때문이다.
  - 만일 우선순위로 수행된다면, 우선순위가 낮은 프로세스는 무기한으로 기다리게 될 수 있다.
- 노화 기법(aging)은 무한 연기를 해결하는 방법으로 프로세스가 자원을 기다리는 시간에 비례하여 우선순위를 부여함으로써 무기한 문제를 방지한다.

### 3. 교착 상태 발생의 4가지 필요조건

- 다음의 네 가지 조건은 교착 상태가 발생하는 필요 조건들이며, 완전히 독립적이지 않다.

#### 상호 배제 조건

- 상호 배제(mutual exclusion)는 프로세스들이 자원을 배타적으로 점유하고 있어서, 다른 프로세스들이 그 자원을 사용할 수 없게 만든다.
- 최소한 한번에 한 프로세스만이 자원을 사용할 수 있으며, 다른 프로세스가 그 자원을 요구하면 자원을 요구한 프로세스는 자원이 해제될 때까지 임계 구역 밖에서 기다려야 한다.

#### 점유와 대기 조건

- 점유와 대기(hold and wait)는 부분 할당이라고도 하는데 프로세스들은 같은 자원이나 다른 종류의 자원을 부가적으로 요구하면서 이미 어떤 자원을 점유하고 있다.
- 최소한 하나의 자원을 점유하는 프로세스가 존재해야 하며, 이 프로세스는 다른 프로세스에 할당된 자원을 추가로 점유하려고 대기해야 한다.

#### 비선점 조건

- 비선점(non-preemption) 자원들은 그들을 점유하는 프로세스로부터 벗어나지 못한며(도중 해제될 수 없다), 단지 프로세스들 자신이 점유한 자원을 해제할 수 있다.
- 자원들은 선점하지 못하며 점유하는 프로세스로 태스크를 종료한 후에 해제할 수 있다.

#### 환형 대기 조건

- 환형 대기(circuler wait)는 프로세스와 자원들이 원형을 이루며 각 프로세스는 자신에게 할당된 자원을 가지면서 상대방의 자원을 상호 요청하는 때를 말한다.
- 환형 대기는 이용할 수 없는 자원을 요구한 프로세스가 자원을 사용할 수 있을 때까지 대기하고 있기 때문에 점유와 대기 조건을 암시한다.
